# 金融數據分析工具 - 隨機過程生成器

## 📊 專案簡介

這是一個使用 C# WinForms 開發的金融數據分析應用程式，專門用於生成和分析金融時間序列數據。本工具實現了多種隨機過程模型，並提供完整的技術分析功能，適合用於金融建模、風險分析和教學用途。

### ✨ 主要特色

- **繁體中文介面** - 完全本地化的使用者介面和變數命名
- **多種隨機過程模型** - 支援幾何布朗運動和 Merton 跳躍擴散模型
- **即時圖表繪製** - 自訂繪圖引擎，無需第三方圖表套件
- **完整統計分析** - 包含波動率、夏普比率、最大回撤等重要指標
- **雜訊模擬** - 可添加白雜訊來模擬市場的隨機性

## 🚀 功能特點

### 🎯 隨機過程生成器

#### 幾何布朗運動 (Geometric Brownian Motion)
- **數學模型**: dS = μSdt + σSdW
- **參數設定**:
  - 初始價格 (1-10,000)
  - 漂移率 (-0.5 到 0.5)
  - 波動率 (0 到 1)
  - 模擬天數 (10-2,000)
- **應用場景**: 經典的股價模型，適用於大多數金融時間序列

#### Merton 跳躍擴散模型
- **數學模型**: dS = μSdt + σSdW + SdJ
- **特點**: 在布朗運動基礎上加入跳躍事件
- **參數**: 跳躍強度、跳躍均值、跳躍波動率
- **應用場景**: 模擬具有突發事件的市場（如財報公布、重大新聞）

### 📈 技術分析功能

#### 移動平均線分析
- **計算方式**: 簡單移動平均 (SMA)
- **可調參數**: 週期天數 (5-200天)
- **視覺化**: 紅色虛線顯示在價格圖表上
- **用途**: 趨勢識別和交易信號生成

#### 統計指標計算
- **年化波動率**: √(Var(returns) × 252)
- **夏普比率**: (平均報酬率 - 無風險利率) / 波動率
- **最大回撤**: 從峰值到谷底的最大跌幅
- **勝率分析**: 上漲天數 vs 下跌天數比例

### 🔊 雜訊生成功能

- **白雜訊添加**: 模擬市場微結構雜訊
- **可調強度**: 0 到 0.1 (建議 0.01)
- **實時更新**: 添加雜訊後自動重新計算所有指標

## 🛠 技術架構

### 開發環境
- **.NET 9.0** - 最新的 .NET 框架
- **Windows Forms** - 桌面應用程式開發
- **MathNet.Numerics** - 高精度數學計算庫

### 核心類別架構

```
WinFormsApp3/
├── 金融數據 (FinancialData)
│   ├── 日期、開盤價、最高價、最低價、收盤價
│   ├── 成交量、報酬率
│
├── 隨機數據生成器 (StochasticDataGenerator)
│   ├── 生成幾何布朗運動()
│   ├── 生成默頓跳躍擴散()
│   └── 添加白雜訊()
│
└── 金融分析器 (FinancialAnalyzer)
    ├── 計算移動平均()
    ├── 計算波動率()
    └── 計算夏普比率()
```

### 自訂圖表引擎
- **Graphics API**: 使用 System.Drawing 直接繪製
- **響應式設計**: 支援視窗大小調整
- **即時更新**: 數據變更時自動重繪
- **多系列支援**: 同時顯示價格線和移動平均線

## 📝 使用說明

### 1. 環境準備
```bash
# 確保已安裝 .NET 9.0 SDK
dotnet --version

# 克隆或下載專案
cd WinFormsApp3

# 還原套件
dotnet restore
```

### 2. 建置專案
```bash
# 建置應用程式
dotnet build

# 執行應用程式
dotnet run
```

### 3. 操作步驟

#### 步驟一：設定參數
1. 選擇隨機過程模型（幾何布朗運動或 Merton 跳躍擴散）
2. 設定初始價格（建議：100）
3. 設定漂移率（建議：0.05，即 5% 年化成長）
4. 設定波動率（建議：0.2，即 20% 年化波動）
5. 設定模擬天數（建議：252，即一年）

#### 步驟二：生成數據
1. 點擊「生成數據」按鈕
2. 觀察圖表中的價格走勢
3. 查看右側統計資訊面板
4. 檢視下方數據表格（顯示最近50筆數據）

#### 步驟三：技術分析
1. 勾選「顯示移動平均線」
2. 設定移動平均週期（建議：20天）
3. 點擊「執行分析」按鈕
4. 觀察紅色虛線的移動平均線

#### 步驟四：添加雜訊（可選）
1. 設定雜訊水平（建議：0.01）
2. 點擊「添加雜訊」按鈕
3. 觀察價格的微小波動變化

## 📊 統計指標說明

### 基本統計
- **當前價格**: 最後一天的收盤價
- **總報酬率**: (當前價格 - 初始價格) / 初始價格
- **最高/最低價格**: 整個期間的極值

### 風險指標
- **年化波動率**: 衡量價格波動程度，數值越高風險越大
- **夏普比率**: 衡量風險調整後報酬，數值越高表現越好
- **最大回撤**: 投資期間的最大虧損幅度

### 交易統計
- **上漲/下跌天數**: 正負報酬率的天數統計
- **勝率**: 上漲天數 / 總交易天數
- **平均成交量**: 模擬的日均交易量

## 🎓 應用場景

### 教育用途
- **金融工程課程**: 演示隨機過程在金融中的應用
- **風險管理教學**: 理解波動率和 VaR 概念
- **投資學**: 說明技術分析指標的計算方法

### 研究應用
- **模型驗證**: 測試交易策略在不同市場條件下的表現
- **參數敏感性分析**: 觀察不同參數對結果的影響
- **蒙地卡羅模擬**: 生成大量路徑進行統計分析

### 實務參考
- **投資組合分析**: 理解資產價格的統計特性
- **風險評估**: 計算 VaR 和壓力測試
- **演算法交易**: 回測移動平均等技術指標

## ⚙️ 系統需求

### 最低需求
- **作業系統**: Windows 10 或更新版本
- **記憶體**: 4GB RAM
- **處理器**: 雙核心 2.0GHz
- **.NET**: .NET 9.0 Runtime

### 建議配置
- **作業系統**: Windows 11
- **記憶體**: 8GB RAM 或以上
- **處理器**: 四核心 3.0GHz 或以上
- **顯示器**: 1920x1080 解析度

## 📦 相依套件

```xml
<PackageReference Include="MathNet.Numerics" Version="5.0.0" />
```

- **MathNet.Numerics**: 提供高精度數學運算功能
  - 常態分布隨機數生成
  - 泊松分布模擬
  - Mersenne Twister 隨機數產生器

## 🔧 自訂與擴展

### 添加新的隨機過程模型
1. 在 `隨機數據生成器` 類別中添加新方法
2. 實現相應的數學模型
3. 在 UI 的下拉選單中添加選項
4. 更新 `buttonGenerate_Click` 事件處理

### 添加新的技術指標
1. 在 `金融分析器` 類別中添加計算方法
2. 在圖表繪製中添加視覺化邏輯
3. 更新統計資訊顯示

### 匯出功能擴展
```csharp
// 示例：CSV 匯出功能
public void 匯出至CSV(List<金融數據> 數據, string 檔案路徑)
{
    using (var writer = new StreamWriter(檔案路徑))
    {
        writer.WriteLine("日期,開盤價,最高價,最低價,收盤價,成交量,報酬率");
        foreach (var 項目 in 數據)
        {
            writer.WriteLine($"{項目.日期:yyyy-MM-dd},{項目.開盤價:F2}," +
                           $"{項目.最高價:F2},{項目.最低價:F2}," +
                           $"{項目.收盤價:F2},{項目.成交量:F0},{項目.報酬率:F6}");
        }
    }
}
```

## 🐛 已知問題與解決方案

### 圖表顯示問題
- **問題**: 數據量太大時圖表可能顯示不清楚
- **解決**: 限制顯示最近的數據點，或實現縮放功能

### 效能考量
- **問題**: 大量數據計算可能較慢
- **解決**: 實現非同步計算或進度條顯示

### 記憶體使用
- **問題**: 長時間運行可能累積記憶體使用
- **解決**: 適當清理舊數據或實現數據分頁

## 📞 支援與貢獻

### 意見回饋
如果您在使用過程中遇到問題或有改進建議，歡迎提出。

### 貢獻指南
1. Fork 此專案
2. 創建功能分支 (`git checkout -b feature/新功能`)
3. 提交變更 (`git commit -am '添加新功能'`)
4. 推送到分支 (`git push origin feature/新功能`)
5. 創建 Pull Request

## 📄 授權條款

本專案使用 MIT 授權條款，詳情請參閱 LICENSE 文件。

## 🙏 致謝

- **MathNet.Numerics** - 提供強大的數學計算功能
- **Microsoft** - .NET 框架和 WinForms 技術
- **金融工程社群** - 隨機過程理論和實務經驗分享

---

**版本**: 1.0.0  
**最後更新**: 2024年12月  
**開發者**: WinFormsApp3 團隊